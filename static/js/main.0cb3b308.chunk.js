(this["webpackJsonptask-app"]=this["webpackJsonptask-app"]||[]).push([[0],{12:function(e,t,n){e.exports={form:"CreateTask_form__2sAGP",CreateTaskInputs:"CreateTask_CreateTaskInputs__1YwNT",Btn:"CreateTask_Btn__KR774"}},14:function(e,t,n){e.exports={MassageContainer:"Massage_MassageContainer__3FCrF",rSuccess:"Massage_rSuccess__2qDJP",rError:"Massage_rError__2C-Ci"}},24:function(e,t,n){e.exports=n(36)},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(15),o=n.n(s),c=n(3),u=n(5),l=n(19);var i=Object(c.b)((function(e){return{isAdmin:e.isAdmin}}),null)((function(e){var t=e.isAdmin;return r.a.createElement("div",{className:u.IconContainer},t?r.a.createElement("h2",{className:u.Logo},r.a.createElement(l.b,null),r.a.createElement("span",null,"\u0410\u0434\u043c\u0438\u043d")):r.a.createElement("h2",{className:u.Logo},r.a.createElement(l.a,null),r.a.createElement("span",null,"\u0413\u043e\u0441\u0442\u044c")))})),m=n(2),_=n(8),p=n(4),E=n.n(p),d=n(22),S=new function e(t,n){Object(d.a)(this,e);var a=t,r=n;this.sort_field=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";return"&sort_field=".concat(e)},this.sort_direction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc";return"&sort_direction=".concat(e)},this.page=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return"".concat(a,"?developer=").concat(r,"&page=").concat(e)},this.login=function(){return"".concat(a,"login?developer=").concat(r)},this.edit=function(e){return"".concat(a,"edit/").concat(e,"?developer=").concat(r)},this.create=function(){return"".concat(a,"create?developer=").concat(r)}}("https://uxcandy.com/~shapoval/test-task-backend/v2/","Anton-Petrenko");function T(e,t){return{type:"FETCH_TASK_LIST_SUCCESS",taskList:e,total_task_count:t}}function f(e){return{type:"FETCH_TASK_LIST_ERROR",errorMassage:e}}function g(e,t){return{type:"POSTING_EDITED_DATA_ERROR",responseStatus:e,responseMessage:t="\u041d\u0435\u0432\u0430\u043b\u0438\u0434\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d"===t?"\u0423 \u0432\u0430\u0441 \u043d\u0435\u0442 \u043f\u0440\u0430\u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430.":t}}function k(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:localStorage.getItem("currentPagePosition")||1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:localStorage.getItem("sortField")||"id",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:localStorage.getItem("sortDirection")||"asc";return function(a){var r,s,o,c,u;return E.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,a({type:"FETCH_TASK_LIST_START"}),l.next=4,E.a.awrap(fetch(S.page(e)+S.sort_field(t)+S.sort_direction(n)));case 4:return r=l.sent,l.next=7,E.a.awrap(r.json());case 7:if("ok"===(s=l.sent).status){for(o=s.message.tasks,c=[],u=1;u<=Math.ceil(s.message.total_task_count/3);u++)c.push(1);a(T(o,c))}else a(f(s.message.error));l.next=14;break;case 11:l.prev=11,l.t0=l.catch(0),console.log(l.t0);case 14:case"end":return l.stop()}}),null,null,[[0,11]])}}function v(){return function(e){e((localStorage.removeItem("token"),{type:"EXIT",isAdmin:!1})),e(k())}}var C=Object(c.b)((function(e){return{isAdmin:e.isAdmin}}),(function(e){return{onLogin:function(t){return e(function(e){return function(t){var n,a;return E.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t({type:"FETCH_LOGIN_TOKEN_START"}),r.next=4,E.a.awrap(fetch(S.login(),{method:"POST",body:e}));case 4:return n=r.sent,r.next=7,E.a.awrap(n.json());case 7:"ok"===(a=r.sent).status?(t({type:"FETCH_LOGIN_TOKEN_SUCCESS",token:a.message.token}),localStorage.setItem("token",a.message.token)):(setTimeout((function(){t({type:"MESSAGE_REFRESH"})}),3e3),t((s=a.message.password,o=a.status,{type:"FETCH_LOGIN_TOKEN_ERROR",responseMassage:s,responseStatus:o}))),r.next=14;break;case 11:throw r.prev=11,r.t0=r.catch(0),console.log(r.t0);case 14:case"end":return r.stop()}var s,o}),null,null,[[0,11]])}}(t))},onLogout:function(){return e(v())}}}))((function(e){var t=e.onLogin,n=e.isAdmin,s=e.onLogout,o={username:"",password:""},c=Object(a.useState)(o),l=Object(_.a)(c,2),i=l[0],p=l[1],E=function(e){var t=Object(m.a)({},i);t[e.target.id]=e.target.value,p(t)};return r.a.createElement(r.a.Fragment,null,n?r.a.createElement("button",{className:u.Btn,onClick:s},"\u0412\u044b\u0445\u043e\u0434"):r.a.createElement("form",{className:u.Form,onSubmit:function(e){e.preventDefault();var n=new FormData;n.append("username",i.username),n.append("password",i.password),p(o),t(n)}},r.a.createElement("div",{className:u.FormGroup},r.a.createElement("input",{type:"text",id:"username",value:i.username,onChange:E,placeholder:"\u041b\u043e\u0433\u0438\u043d",required:!0})),r.a.createElement("div",{className:u.FormGroup},r.a.createElement("input",{type:"password",id:"password",value:i.password,onChange:E,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",required:!0})),r.a.createElement("button",{className:u.Btn},"\u0412\u043e\u0439\u0442\u0438")))})),h=function(){return r.a.createElement("header",{className:u.header},r.a.createElement(i,null),r.a.createElement(C,null))},b=n(12);var O=Object(c.b)(null,(function(e){return{onSetNewTask:function(t){return e(function(e){return function(t){var n,a;return E.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t({type:"START_SENDING_NEW_TASK"}),r.next=4,E.a.awrap(fetch(S.create(),{method:"POST",body:e}));case 4:return n=r.sent,r.next=7,E.a.awrap(n.json());case 7:"ok"===(a=r.sent).status?(setTimeout((function(){t({type:"MESSAGE_REFRESH"})}),3e3),t({type:"SENDING_NEW_TASK_SUCCESS",responseStatus:a.status}),t(k())):t({type:"SENDING_NEW_TASK_ERROR"}),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(0),console.log(r.t0);case 14:case"end":return r.stop()}}),null,null,[[0,11]])}}(t))}}}))((function(e){var t=e.onSetNewTask,n={username:"",email:"",text:""},s=Object(a.useState)(n),o=Object(_.a)(s,2),c=o[0],u=o[1],l=function(e){var t=Object(m.a)({},c);t[e.target.name]=e.target.value,u(t)};return r.a.createElement("form",{className:b.form,onSubmit:function(e){e.preventDefault();var a=new FormData;a.append("username",c.username),a.append("email",c.email),a.append("text",c.text),u(n),t(a)}},r.a.createElement("input",{className:b.CreateTaskInputs,type:"text",name:"username",onChange:l,value:c.username,placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",required:!0}),r.a.createElement("input",{className:b.CreateTaskInputs,type:"email",name:"email",onChange:l,value:c.email,placeholder:"E-mail",required:!0}),r.a.createElement("input",{className:b.CreateTaskInputs,type:"text",name:"text",onChange:l,value:c.text,placeholder:"\u0417\u0430\u0434\u0430\u0447\u0430",required:!0}),r.a.createElement("button",{className:b.Btn},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"))})),N=n(11),A=n(9);var I=Object(c.b)((function(e){return{isAdmin:e.isAdmin,adminToken:e.adminToken}}),(function(e){return{onEdit:function(t,n){return e(function(e,t){return function(n){var a,r;return E.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,n({type:"START_POSTING_EDITED_DATA"}),s.next=4,E.a.awrap(fetch(S.edit(e),{method:"POST",body:t}));case 4:return a=s.sent,s.next=7,E.a.awrap(a.json());case 7:r=s.sent,console.log(r),"ok"===r.status?(setTimeout((function(){n({type:"MESSAGE_REFRESH"})}),3e3),n({type:"POSTING_EDITED_DATA_SUCCESS",responseStatus:r.status}),n(k())):(setTimeout((function(){n({type:"MESSAGE_REFRESH"})}),3e3),n(g(r.status,r.message.token))),s.next=15;break;case 12:s.prev=12,s.t0=s.catch(0),console.log(s.t0);case 15:case"end":return s.stop()}}),null,null,[[0,12]])}}(t,n))}}}))((function(e){var t=e.id,n=e.username,s=e.email,o=e.text,c=e.status,u=e.isAdmin,l=e.onEdit;c=!!c;var i;o.endsWith("AdminEdit")&&(i=!0,o=o.slice(0,o.length-"AdminEdit".length));var p=Object(a.useState)({text:o,status:c}),E=Object(_.a)(p,2),d=E[0],S=E[1],T=function(e){var t=Object(m.a)({},d);"status"===e.target.name?t[e.target.name]=!t[e.target.name]:t[e.target.name]=e.target.value,S(t)},f=function(e){e.preventDefault();var n=new FormData;o!==d.text&&n.append("text",d.text+"AdminEdit"),n.append("status",d.status?"10":"0"),n.append("token",localStorage.getItem("token")),l(t,n)};return r.a.createElement("li",{className:A.Task},r.a.createElement("label",{className:A.TaskLabel,htmlFor:t},d.status?r.a.createElement(N.c,null):r.a.createElement(N.d,null)),r.a.createElement("form",{className:A.TaskForm,onSubmit:f},r.a.createElement("textarea",{className:A.TaskTextarea,name:"text",value:d.text,onChange:u?T:function(){return console.log("\u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c")}}),r.a.createElement("input",{style:{display:"none"},type:"checkbox",name:"status",id:t,checked:d.status,onChange:u?T:f}),r.a.createElement("span",null,"\u0418\u043c\u044f: ",n),r.a.createElement("span",null,"E-mail: ",s),r.a.createElement("span",null,i&&"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u043e\u043c")),r.a.createElement("button",{className:A.Btn,onClick:f},"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"))}));var x=Object(c.b)((function(e){return{taskList:e.taskList,total_task_count:e.total_task_count}}),(function(e){return{onLoad:function(t){return e(k(t))}}}))((function(e){var t=e.taskList,n=e.onLoad;return Object(a.useEffect)((function(){n()}),[]),r.a.createElement("div",{className:A.TaskContainer},r.a.createElement("ul",null,t.length?t.map((function(e){return r.a.createElement(I,Object.assign({key:e.id,id:e.id},e))})):r.a.createElement("h2",null,"\u041d\u0435\u0442 \u0437\u0430\u0434\u0430\u043d\u0438\u0439 \u043d\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f")))})),j=n(7),R=function(e){var t=e.num,n=e.handleClick;return r.a.createElement("button",{className:j.Btn,style:localStorage.getItem("currentPagePosition")==="".concat(t)?{color:"red"}:null,onClick:function(){localStorage.setItem("currentPagePosition","".concat(t)),n(t)}},t)};var y=Object(c.b)((function(e){return{total_task_count:e.total_task_count}}),(function(e){return{onLoad:function(t){return e(k(t))}}}))((function(e){var t=e.total_task_count,n=e.onLoad;return r.a.createElement("section",null,r.a.createElement("div",{className:j.BtnPaginationContainer},t.length?t.map((function(e,t){return r.a.createElement(R,{handleClick:n,key:t,num:t+1})})):null))}));var F=Object(c.b)(null,(function(e){return{onSort:function(t,n,a){return e(k(t,n,a))}}}))((function(e){var t=e.onSort,n=e.sortField,s=Object(a.useState)({clickCount:1,direction:"asc"}),o=Object(_.a)(s,2),c=o[0],u=o[1];Object(a.useEffect)((function(){1!==c.clickCount&&(localStorage.setItem("sortDirection",c.direction),localStorage.setItem("sortField",n),t(localStorage.getItem("currentPagePosition"),n))}));return r.a.createElement("div",null,r.a.createElement("button",{className:j.Btn,onClick:function(){c.clickCount%2===0?u((function(e){return{clickCount:e.clickCount+1,direction:"desc"}})):u((function(e){return{clickCount:e.clickCount+1,direction:"asc"}}))}},n,"asc"===c.direction?r.a.createElement(N.a,null):r.a.createElement(N.b,null)))})),L=function(){return r.a.createElement("div",{className:j.BtnSortContainer},["\u0441\u0442\u0430\u0442\u0443\u0441","\u0438\u043c\u044f","email"].map((function(e,t){return r.a.createElement(F,{sortField:e,key:t})})))},D=n(14);var w=Object(c.b)((function(e){return{responseStatus:e.responseStatus,responseMessage:e.responseMessage}}))((function(e){var t=e.responseMessage,n=e.responseStatus;return r.a.createElement(r.a.Fragment,null,n.length?r.a.createElement("div",{className:D.MassageContainer},r.a.createElement("h2",{className:"ok"===n?D.rSuccess:D.rError},t||"\u0423\u0441\u043f\u0435\u0448\u043d\u043e")):r.a.createElement("div",{className:D.MassageContainer}))}));n(35);var M=function(){return r.a.createElement("div",{className:"wrapper"},r.a.createElement(h,null),r.a.createElement("main",null,r.a.createElement(w,null),r.a.createElement(O,null),r.a.createElement(y,null),r.a.createElement(L,null),r.a.createElement(x,null)))},G=n(13),B={taskList:[],isAdmin:!!localStorage.getItem("token"),responseStatus:"",responseMessage:"",total_task_count:""},P=n(23),K=Object(G.c)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_LOGIN_TOKEN_START":return Object(m.a)({},e);case"FETCH_LOGIN_TOKEN_SUCCESS":return Object(m.a)({},e,{isAdmin:!0,adminToken:t.token});case"FETCH_LOGIN_TOKEN_ERROR":return Object(m.a)({},e,{isAdmin:!1,responseMessage:t.responseMassage,responseStatus:t.responseStatus});case"FETCH_TASK_LIST_START":return Object(m.a)({},e);case"FETCH_TASK_LIST_SUCCESS":return Object(m.a)({},e,{taskList:t.taskList,total_task_count:t.total_task_count});case"FETCH_TASK_LIST_ERROR":return Object(m.a)({},e,{errorMassage:t.errorMassage});case"START_POSTING_EDITED_DATA":return Object(m.a)({},e);case"POSTING_EDITED_DATA_SUCCESS":return Object(m.a)({},e,{responseStatus:t.responseStatus});case"POSTING_EDITED_DATA_ERROR":return Object(m.a)({},e,{isAdmin:!1,responseStatus:t.responseStatus,responseMessage:t.responseMessage});case"START_SENDING_NEW_TASK":return Object(m.a)({},e);case"SENDING_NEW_TASK_SUCCESS":return Object(m.a)({},e,{responseStatus:t.responseStatus,responseMessage:""});case"SENDING_NEW_TASK_ERROR":return Object(m.a)({},e);case"EXIT":return Object(m.a)({},e,{adminToken:t.adminToken,isAdmin:t.isAdmin});case"MESSAGE_REFRESH":return Object(m.a)({},e,{responseStatus:"",responseMessage:""});default:return e}}),Object(G.a)(P.a)),H=r.a.createElement(c.a,{store:K},r.a.createElement(M,null));o.a.render(H,document.getElementById("root"))},5:function(e,t,n){e.exports={header:"header_header__3OGO0",Form:"header_Form__2UcT0",FormGroup:"header_FormGroup__2qyAc",Btn:"header_Btn__1WUdQ",Logo:"header_Logo__2MM7I"}},7:function(e,t,n){e.exports={Btn:"ControllButtons_Btn__1Li3r",BtnPaginationContainer:"ControllButtons_BtnPaginationContainer__2jo8a",BtnSortContainer:"ControllButtons_BtnSortContainer__2gxdE"}},9:function(e,t,n){e.exports={TaskContainer:"Task_TaskContainer__39SHD",Task:"Task_Task__1GcLs",TaskLabel:"Task_TaskLabel__1lmXM",TaskForm:"Task_TaskForm__1_xi6",TaskTextarea:"Task_TaskTextarea__greOa",Btn:"Task_Btn__2E27L"}}},[[24,1,2]]]);
//# sourceMappingURL=main.0cb3b308.chunk.js.map